考虑从输入向量$$ x $$预测单一连续目标变量$$ t $$的问题（扩展到多个目标变量的情形很容易）。我们假设条件概率分布$$ p(t|x) $$是一个高斯分布，均值与$$ x $$有关，由神经网络模型的输出$$ y(x, w) $$确定，精度（方差的逆）$$ \beta $$为

$$
p(t|x,w,\beta) = \mathcal{N}(t|y(x,w),\beta^{-1}) \tag{5.161}
$$

同样的，我们将权值$$ w $$的先验概率分布设为形式为

$$
p(w|\alpha) = \mathcal{N}(w|O,\alpha^{-1}I) \tag{5.162}
$$

的高斯分布。对于$$ N $$次独立同分布的观测$$ x_1,...,x_N $$，对应的目标值集合$$ D = {t_1,...,t_N} $$，似然函数为    

$$
p(D|w,\beta) = \prod\limits_{n=1}^N\mathcal{N}(t_n|y(x_n,w),\beta^{-1}) \tag{5.163}
$$

因此最终的后验概率为

$$
p(w|D,\alpha,\beta) \propto p(w|\alpha)p(D|w,\beta) \tag{5.164}
$$

由于$$ y(x, w) $$与$$ w $$的关系是非线性的，因此后验概率不是高斯分布。    

使用拉普拉斯近似，我们可以找到对于后验概率分布的一个高斯近似。为了达到这个目的，我们必须首先需要得到使用迭代的数值最优化算法才能找到的后验概率分布的一个（局部）最大值。同样的，比较方便的做法是最大化后验概率分布的对数：    

$$
\ln p(w|D) = -\frac{\alpha}{2}w^Tw - \frac{\beta}{2}\sum\limits_{n=1}^N\{y(x_n,w) - t_n\}^2 + const \tag{5.165}
$$

这对应于一个正则化的平方和误差函数。假设$$ \alpha, \beta $$都是定值，那么我们可以通过标准的非线性最优化算法（如共轭梯度法），使用误差反向传播计算所需的导数，找到后验概率的最大值。我们将最大值的位置记作$$ w_{MAP} $$。    

找到了$$ w_{MAP} $$的众数，我们就可以通过计算后验概率分布的负对数的二阶导数，建立一个局部的高斯近似。根据式（5.165），负对数后验概率的二阶导数为    

$$
A = -\nabla\nabla\ln p(w|D,\alpha,\beta) = \alpha I + \beta H \tag{5.166}
$$

这里，$$ H $$是一个Hessian矩阵，由平方和误差函数关于$$ w $$的分量组成。计算和近似Hessian矩阵的方法已经在4节讨论过。这样，根据式（4.134）可以得到后验概率对应的形式为

$$
q(w|D) = \mathcal{N}(w|w_{MAP},A^{-1}) \tag{5.167}
$$

高斯近似。同样，预测分布可以通过将后验概率分布求积分的方式获得

$$
p(t|x,D) = \int p(t|x,w)q(w|D)dw \tag{5.168}
$$

然而，即使是后验分布的高斯近似，因为网络函数$$ y(x,w) $$与$$ w $$的关系是非线性的，这个积分仍然无法得到解析解。为了将计算过程进行下去，现在我们假设，与$$ y(x,w) $$发生变化造成的$$ w $$的变化幅度相比，后验概率分布的方差较小。这使得我们可以在$$ w_{MAP} $$附近对网络函数进行泰勒展开。只保留展开式的线性项，可得：    

$$
y(x,w) \simeq y(x,w_{MAP}) + g^T(w - w_{MAP}) \tag{5.169}
$$

其中我们定义

$$
g = \nabla_wy(x,w)\vert_{w=w_{MAP}} \tag{5.170}
$$

使用这个近似，我们得到了一个线性高斯模型，$$ p(w) $$为高斯分布。且$$ p(t|w) $$也是高斯分布，它的均值是$$ w $$的线性函数，分布的形式为     

$$
p(t|x,w,\beta) \simeq \mathcal{N}(t|y(x,w_{MAP}) + g^T(w-w_{MAP}), \beta^{-1}) \tag{5.171}
$$

于是我们可以使用式（2.115）给出的边缘分布$$ p(t) $$的一般结果，得到

$$
p(t|x,D,\alpha,\beta) = \mathcal{N}(t|y(x,w_{MAP}),\sigma^2(x)) \tag{5.172}
$$

其中，与输入相关的方差为

$$
\sigma^2(x) = \beta^{-1} + g^TA^{-1}g \tag{5.173}
$$

我们看到预测分布$$ p(t|x,D) $$是一个高斯分布，它的均值由网络函数$$ y(x,w_{MAP}) $$给出，参数设置为了MAP值。方差由两项组成：第一项来自目标变量的固有噪声，第二项是一个与$$ x $$相关的项，表示由于模型参数$$ w $$的不确定性造成的内插的不确定性。可以将这个结果与式（3.58）和（3.59）给出的线性回归模型的对应的预测分布进行对比。
